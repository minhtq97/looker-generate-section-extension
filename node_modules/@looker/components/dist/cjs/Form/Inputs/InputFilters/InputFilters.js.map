{"version":3,"file":"InputFilters.js","names":["_styledComponents","_interopRequireDefault","require","_react","_interopRequireWildcard","_Close","_FilterList","_Select","_InputText","_Icon","_Button","_Chip","_Text","_Popover","_utils","_InputFiltersChip","_inputFilterEditor","_templateObject","_templateObject2","_excluded","_excluded2","_excluded3","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","value","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","iter","iterator","Array","from","isArray","_arrayLikeToArray","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","toString","constructor","name","test","len","arr2","_i","_s","_e","_x","_r","_arr","_n","_d","next","done","err","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","InputFiltersLayout","_ref","className","filters","_ref$hideFilterIcon","hideFilterIcon","onChange","props","_useTranslation","useTranslation","t","placeholder","_useState","useState","_useState2","fieldEditing","setFieldEditing","assignedFilters","field","sort","a","b","unassignedFilters","map","assigned","includes","_useState3","_useState4","filterTerm","setFilterTerm","options","useMemo","reduce","acc","option","label","optionMatchesFilter","values","some","toLocaleLowerCase","concat","inputRef","useRef","isClearable","clearFilters","_ref2","rest","focusInput","current","focus","handleFilterLookupChange","find","createElement","onClick","Icon","color","mr","mt","icon","FilterList","size","ChipWrapper","editor","editFilter","handleDelete","currentFilter","_value","setFieldEditingValue","filterIndex","findIndex","f","newFilters","updateFilter","closeEditor","filterToken","InputFiltersChip","onDelete","Text","fontSize","lineHeight","Popover","content","PopoverContent","filterOptions","inputFilterEditor","isOpen","placement","setOpen","Select","autoResize","openOnFocus","indicator","onFilter","isFilterable","ref","IconButton","Close","ml","styled","div","withConfig","displayName","componentId","_ref3","theme","space","u1","Chip","InputFilters","inputCSS","_ref4","u05","_ref5","u2","inputTextFocus","_ref6","InputText","exports"],"sources":["../../../../../src/Form/Inputs/InputFilters/InputFilters.tsx"],"sourcesContent":["/*\n\n MIT License\n\n Copyright (c) 2022 Looker Data Sciences, Inc.\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in all\n copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n SOFTWARE.\n\n */\n\nimport styled from 'styled-components';\nimport React, { useMemo, useState, useRef } from 'react';\nimport { Close } from '@styled-icons/material/Close';\nimport { FilterList } from '@styled-icons/material/FilterList';\nimport type { SelectOptionObject } from '../Select';\nimport { Select } from '../Select';\nimport { InputText, inputTextFocus, inputCSS } from '../InputText';\nimport { Icon } from '../../../Icon';\nimport { IconButton } from '../../../Button';\nimport { Chip } from '../../../Chip';\nimport { Text } from '../../../Text';\nimport { Popover, PopoverContent } from '../../../Popover';\nimport { useTranslation } from '../../../utils';\nimport { InputFiltersChip } from './InputFiltersChip';\nimport { inputFilterEditor } from './inputFilterEditor';\nimport type { InputFiltersProps } from './types';\n\nconst InputFiltersLayout = ({\n  className,\n  filters,\n  hideFilterIcon = false,\n  onChange,\n  ...props\n}: InputFiltersProps) => {\n  const { t } = useTranslation('InputFilters');\n  const placeholder = props.placeholder || t('Filter List');\n  const [fieldEditing, setFieldEditing] = useState<undefined | string>(\n    undefined\n  );\n\n  const assignedFilters = filters\n    .filter(filter => filter.value || filter.field === fieldEditing)\n    .sort((a, b) => {\n      if (a.value === undefined) {\n        return 1;\n      } else if (b.value === undefined) {\n        return -1;\n      } else {\n        return 0;\n      }\n    });\n\n  const unassignedFilters = filters.filter(\n    filter =>\n      !assignedFilters.map(assigned => assigned.field).includes(filter.field)\n  );\n\n  const [filterTerm, setFilterTerm] = useState('');\n\n  const options = useMemo(\n    () =>\n      unassignedFilters.reduce((acc: SelectOptionObject[], filter) => {\n        const option = {\n          label: filter.label || filter.field,\n          value: filter.field,\n        };\n        const optionMatchesFilter = Object.values(option).some(\n          (value: string) =>\n            value.toLocaleLowerCase().indexOf(filterTerm.toLocaleLowerCase()) >\n            -1\n        );\n        if (optionMatchesFilter) {\n          acc = [...acc, option];\n        }\n        return acc;\n      }, []),\n    [filterTerm, unassignedFilters]\n  );\n\n  const inputRef = useRef<null | HTMLInputElement>(null);\n  const isClearable = assignedFilters.length > 0;\n\n  const clearFilters = () => {\n    onChange(filters.map(({ value, ...rest }) => rest));\n  };\n\n  const focusInput = () => inputRef.current && inputRef.current.focus();\n\n  const handleFilterLookupChange = (field: string) => {\n    const filter = filters.find(option => option.field === field);\n    if (filter) {\n      setFieldEditing(filter.field);\n    }\n  };\n\n  return (\n    <div className={className} onClick={focusInput}>\n      {!hideFilterIcon && (\n        <Icon\n          color=\"ui4\"\n          mr=\"xsmall\"\n          mt=\"xxsmall\"\n          icon={<FilterList />}\n          size={20}\n        />\n      )}\n      <ChipWrapper>\n        {assignedFilters.map((filter, i) => {\n          const { editor, field, value } = filter;\n\n          const editFilter = () => setFieldEditing(field);\n\n          const handleDelete = () =>\n            onChange(\n              filters.map(currentFilter => {\n                if (currentFilter.field !== field) {\n                  return currentFilter;\n                }\n                const { value: _value, ...rest } = currentFilter;\n                return rest;\n              })\n            );\n\n          const setFieldEditingValue = (value?: string) => {\n            const filterIndex = assignedFilters.findIndex(\n              f => f.field === fieldEditing\n            );\n\n            const newFilters = [...assignedFilters, ...unassignedFilters];\n            const updateFilter = { ...newFilters[filterIndex], value };\n            newFilters[filterIndex] = updateFilter;\n\n            onChange(newFilters);\n          };\n\n          const closeEditor = () => setFieldEditing(undefined);\n\n          const filterToken = value ? (\n            <InputFiltersChip\n              filter={filter}\n              key={i}\n              onClick={editFilter}\n              onDelete={handleDelete}\n            />\n          ) : (\n            <Text fontSize=\"small\" lineHeight=\"xlarge\">\n              {filter?.label || filter.field}:\n            </Text>\n          );\n          return filter.field === fieldEditing ? (\n            <Popover\n              content={\n                <PopoverContent>\n                  {editor\n                    ? editor({\n                        closeEditor,\n                        filterOptions: filter,\n                        onChange: setFieldEditingValue,\n                        value,\n                      })\n                    : inputFilterEditor({\n                        closeEditor,\n                        filterOptions: filter,\n                        onChange: setFieldEditingValue,\n                        value,\n                      })}\n                </PopoverContent>\n              }\n              isOpen={fieldEditing !== undefined}\n              key={i}\n              placement=\"bottom-start\"\n              setOpen={closeEditor}\n            >\n              {filterToken}\n            </Popover>\n          ) : (\n            filterToken\n          );\n        })}\n        {!fieldEditing && (\n          <Select\n            autoResize\n            openOnFocus\n            indicator={false}\n            onFilter={setFilterTerm}\n            isFilterable\n            onChange={handleFilterLookupChange}\n            options={options}\n            placeholder={placeholder}\n            ref={inputRef}\n          />\n        )}\n      </ChipWrapper>\n      {isClearable && (\n        <IconButton\n          icon={<Close />}\n          label={t('Clear Filters')}\n          ml=\"auto\"\n          mt=\"xxsmall\"\n          mr=\"xsmall\"\n          onClick={clearFilters}\n          size=\"xsmall\"\n        />\n      )}\n    </div>\n  );\n};\n\nconst ChipWrapper = styled.div`\n  display: inline-flex;\n  flex: 1;\n  flex-wrap: wrap;\n\n  @supports (gap: 4px) {\n    gap: ${({ theme }) => theme.space.u1};\n    ${Chip} {\n      margin: 0;\n    }\n  }\n`;\n\nexport const InputFilters = styled(InputFiltersLayout)`\n  ${inputCSS}\n  align-items: start;\n  display: flex;\n  flex-wrap: wrap;\n  padding: ${({ theme: { space } }) => space.u05} 0;\n  padding-left: ${({ theme: { space } }) => space.u2};\n  width: 100%;\n  &:focus-within {\n    ${inputTextFocus}\n  }\n\n  ${Select} {\n    margin-left: ${({ theme: { space } }) => space.u1};\n  }\n\n  ${Select} ${Icon} {\n    display: none;\n  }\n\n  ${InputText} {\n    border: none;\n    height: 30px;\n    padding: 0;\n\n    &:focus-within {\n      box-shadow: none;\n    }\n\n    input {\n      padding: 0;\n    }\n  }\n`;\n"],"mappings":"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"}
{"version":3,"file":"useOptionEvents.js","names":["_xorWith","_interopRequireDefault","require","_react","_utils","_state","obj","__esModule","useOptionEvents","props","context","label","payload","value","onClick","onMouseEnter","option","_useContext","useContext","data","onChange","transition","closeOnSelectPropRef","isScrollingRef","_ref","options","handleClick","xorWith","o1","o2","ComboboxActionType","SELECT_WITH_CLICK","current","ESCAPE","handleMouseEnter","requestAnimationFrame","NAVIGATE","useWrapEvent"],"sources":["../../../../../../src/Form/Inputs/Combobox/utils/useOptionEvents.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport xorWith from 'lodash/xorWith';\nimport type { Context } from 'react';\nimport { useContext } from 'react';\nimport { useWrapEvent } from '../../../../utils';\nimport type {\n  ComboboxContextProps,\n  ComboboxMultiContextProps,\n} from '../ComboboxContext';\nimport type {\n  ComboboxCallback,\n  ComboboxMultiCallback,\n  ComboboxOptionObject,\n  ComboboxOptionProps,\n} from '../types';\nimport type { ComboboxMultiData } from './state';\nimport { ComboboxActionType } from './state';\n\nexport type UseOptionEventsProps = ComboboxOptionObject &\n  Pick<ComboboxOptionProps, 'onClick' | 'onMouseEnter'>;\n\nexport function useOptionEvents<\n  CProps extends ComboboxContextProps | ComboboxMultiContextProps\n>(props: ComboboxOptionProps, context: Context<CProps>) {\n  const { label, payload, value, onClick, onMouseEnter } = props;\n  const option = { label, payload, value };\n\n  const { data, onChange, transition, closeOnSelectPropRef, isScrollingRef } =\n    useContext(context);\n  const { options } = data as ComboboxMultiData;\n\n  function handleClick() {\n    if (onChange) {\n      if (options) {\n        (onChange as ComboboxMultiCallback)(\n          xorWith(options, [option], (o1, o2) => o1.value === o2.value)\n        );\n      } else {\n        (onChange as ComboboxCallback)(option);\n      }\n    }\n    transition && transition(ComboboxActionType.SELECT_WITH_CLICK, { option });\n    if (closeOnSelectPropRef && closeOnSelectPropRef.current) {\n      // Closing an opened list\n      transition && transition(ComboboxActionType.ESCAPE);\n    }\n  }\n\n  const handleMouseEnter = () => {\n    // Wait for isScrollingRef.current to be updated in ComboboxList scrollHandler\n    // (mouseenter event is fired before the scroll event)\n    requestAnimationFrame(() => {\n      if (isScrollingRef?.current) return;\n      transition && transition(ComboboxActionType.NAVIGATE, { option });\n    });\n  };\n\n  return {\n    onClick: useWrapEvent(handleClick, onClick),\n    onMouseEnter: useWrapEvent(handleMouseEnter, onMouseEnter),\n  };\n}\n"],"mappings":";;;;;;AAKA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,MAAA,GAAAF,OAAA;AAYA,IAAAG,MAAA,GAAAH,OAAA;AAA6C,SAAAD,uBAAAK,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,gBAAAA,GAAA;AAKtC,SAASE,eAAeA,CAE7BC,KAA0B,EAAEC,OAAwB,EAAE;EACtD,IAAQC,KAAK,GAA4CF,KAAK,CAAtDE,KAAK;IAAEC,OAAO,GAAmCH,KAAK,CAA/CG,OAAO;IAAEC,KAAK,GAA4BJ,KAAK,CAAtCI,KAAK;IAAEC,OAAO,GAAmBL,KAAK,CAA/BK,OAAO;IAAEC,YAAY,GAAKN,KAAK,CAAtBM,YAAY;EACpD,IAAMC,MAAM,GAAG;IAAEL,KAAK,EAALA,KAAK;IAAEC,OAAO,EAAPA,OAAO;IAAEC,KAAK,EAALA;EAAM,CAAC;EAExC,IAAAI,WAAA,GACE,IAAAC,iBAAU,EAACR,OAAO,CAAC;IADbS,IAAI,GAAAF,WAAA,CAAJE,IAAI;IAAEC,QAAQ,GAAAH,WAAA,CAARG,QAAQ;IAAEC,UAAU,GAAAJ,WAAA,CAAVI,UAAU;IAAEC,oBAAoB,GAAAL,WAAA,CAApBK,oBAAoB;IAAEC,cAAc,GAAAN,WAAA,CAAdM,cAAc;EAExE,IAAAC,IAAA,GAAoBL,IAAI;IAAhBM,OAAO,GAAAD,IAAA,CAAPC,OAAO;EAEf,SAASC,WAAWA,CAAA,EAAG;IACrB,IAAIN,QAAQ,EAAE;MACZ,IAAIK,OAAO,EAAE;QACVL,QAAQ,CACP,IAAAO,mBAAO,EAACF,OAAO,EAAE,CAACT,MAAM,CAAC,EAAE,UAACY,EAAE,EAAEC,EAAE;UAAA,OAAKD,EAAE,CAACf,KAAK,KAAKgB,EAAE,CAAChB,KAAK;QAAA,EAC9D,CAAC;MACH,CAAC,MAAM;QACJO,QAAQ,CAAsBJ,MAAM,CAAC;MACxC;IACF;IACAK,UAAU,IAAIA,UAAU,CAACS,yBAAkB,CAACC,iBAAiB,EAAE;MAAEf,MAAM,EAANA;IAAO,CAAC,CAAC;IAC1E,IAAIM,oBAAoB,IAAIA,oBAAoB,CAACU,OAAO,EAAE;MAExDX,UAAU,IAAIA,UAAU,CAACS,yBAAkB,CAACG,MAAM,CAAC;IACrD;EACF;EAEA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAA,EAAS;IAG7BC,qBAAqB,CAAC,YAAM;MAC1B,IAAIZ,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAES,OAAO,EAAE;MAC7BX,UAAU,IAAIA,UAAU,CAACS,yBAAkB,CAACM,QAAQ,EAAE;QAAEpB,MAAM,EAANA;MAAO,CAAC,CAAC;IACnE,CAAC,CAAC;EACJ,CAAC;EAED,OAAO;IACLF,OAAO,EAAE,IAAAuB,mBAAY,EAACX,WAAW,EAAEZ,OAAO,CAAC;IAC3CC,YAAY,EAAE,IAAAsB,mBAAY,EAACH,gBAAgB,EAAEnB,YAAY;EAC3D,CAAC;AACH"}
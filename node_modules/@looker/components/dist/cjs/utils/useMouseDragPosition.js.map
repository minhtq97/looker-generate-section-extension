{"version":3,"file":"useMouseDragPosition.js","names":["_react","require","_throttle","_interopRequireDefault","_get","obj","__esModule","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","isArray","useMouseDragPosition","targetRef","_useState","useState","_useState2","isMouseDown","setIsMouseDown","_useState3","x","y","_useState4","mousePos","setMousePos","updateMousePos","e","event","get","pageX","clientX","pageY","clientY","handleStart","requestAnimationFrame","handleMove","throttle","handleEnd","useEffect","addEventListener","window","removeEventListener"],"sources":["../../../src/utils/useMouseDragPosition.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport { useState, useEffect } from 'react';\nimport throttle from 'lodash/throttle';\nimport get from 'lodash/get';\n\ninterface MouseState {\n  mousePos: { x: number; y: number };\n  isMouseDown: boolean;\n}\n\n/*\n * Starts tracking mouse position when user clicks inside targetRef.\n * Stops  updating mouse position when user releases mouse ANYWHERE in the window\n */\nexport function useMouseDragPosition(\n  targetRef: HTMLElement | null\n): MouseState {\n  const [isMouseDown, setIsMouseDown] = useState(false);\n  const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\n\n  const updateMousePos = (e: globalThis.TouchEvent | globalThis.MouseEvent) => {\n    // use e.touches[0] for touch events, or simply e for mouse events\n    const event = get(e, 'touches[0]', e);\n    // e.clientX and e.clientY fallbacks are included for testing purposes. jsDOM doesn't support pageX/pageY attributes\n    const { pageX, clientX, pageY, clientY } = event;\n    setMousePos({ x: pageX || clientX, y: pageY || clientY });\n  };\n\n  const handleStart = (e: globalThis.TouchEvent | globalThis.MouseEvent) => {\n    // update mouse down state AFTER mouse position state is updated\n    requestAnimationFrame(() => {\n      setIsMouseDown(true);\n    });\n    updateMousePos(e);\n  };\n\n  const handleMove = throttle(updateMousePos, 100);\n\n  const handleEnd = () => {\n    requestAnimationFrame(() => {\n      setIsMouseDown(false);\n    });\n  };\n\n  useEffect(() => {\n    targetRef && targetRef.addEventListener('mousedown', handleStart);\n    targetRef && targetRef.addEventListener('touchstart', handleStart);\n    window.addEventListener('mouseup', handleEnd);\n    window.addEventListener('touchend', handleEnd);\n\n    if (isMouseDown) {\n      window.addEventListener('touchmove', handleMove);\n      window.addEventListener('mousemove', handleMove);\n      window.addEventListener('mouseleave', handleEnd);\n    }\n\n    return () => {\n      targetRef && targetRef.removeEventListener('mousedown', handleStart);\n      targetRef && targetRef.removeEventListener('touchstart', handleStart);\n      window.removeEventListener('mouseup', handleEnd);\n      window.removeEventListener('touchend', handleEnd);\n\n      if (isMouseDown) {\n        window.removeEventListener('touchmove', handleMove);\n        window.removeEventListener('mousemove', handleMove);\n        window.removeEventListener('mouseleave', handleEnd);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isMouseDown, targetRef]);\n\n  return { isMouseDown, mousePos };\n}\n"],"mappings":"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"}